from cryptography.hazmat.primitives.asymmetric import rsa
from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.asymmetric import padding
from cryptography.hazmat.primitives import serialization
import base64

def decrypt_aes_key_with_rsa(encrypted_aes_key_base64, private_key_pem_base64):
    encrypted_aes_key = base64.b64decode(encrypted_aes_key_base64)
    private_key_pem = base64.b64decode(private_key_pem_base64)

    private_key = serialization.load_pem_private_key(private_key_pem, password=None)

    decrypted_aes_key = private_key.decrypt(
        encrypted_aes_key,
        padding.OAEP(
            mgf=padding.MGF1(algorithm=hashes.SHA256()),
            algorithm=hashes.SHA256(),
            label=None
        )
    )

    decrypted_aes_key_base64 = base64.b64encode(decrypted_aes_key).decode('utf-8')

    return decrypted_aes_key_base64

encrypted_aes_key_base64 = "1EQsMLFsf5aPUaq86N5cDwSxQ/XIFVwqbszPfZwFmm45Lk6sU8iGjcZzlB6QFgvkrW2bELsu0kbxyEyxq08+/qlw/Xq59nCLo7SWMppEmc4m3xh7DRp1InQv/skqZNc//bhBJUnWicmGeVkmE+uDMXG2o4JWF3XOXGib7cAEIgXhWUOiMbXY79amejdCxoZ8j6bZmD4lkOJS3RXUpk5tRSUGuqlvPhvZ6HBNENY33GZK108TJPuTm2m+FtvF4a2rwxNvqiTTv+ih0Sk0wl5ib4nXG9Uf8Zrp2GLZPNbGwQQSMNyI6A0nu4W6bb2XEi4+xheaaaBmPWmr7VWebWZhYQ=="
private_key_pem_base64 = "LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2QUlCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktZd2dnU2lBZ0VBQW9JQkFRRGpjUm43eXYxUzdEY2gKc3ZwL2toL2ptSWQ0eG5vWlZVUXdYTk9RUVBrU0d5enY2T3lRMGE4WG00Yzl4S2RsS29pcmFxZlNPT1I4S3JvYQpmMGQwMnFDT01ZZnNybUpOOTNaRGZoKzROekpXWUdVZWtTZ1ZkMmlROGh4VzJqWDFjRDR5VytJN1c5YnhKTG1CCkVNWG96S28reVlaZENJaS9mY0U3K3pmZW0wck1mTjJiUkhXNU95OW9HaVRBTWt4ZUswQ01WbmJZMjNYODJRVloKdXNwY0kwY1F1WGRLRklwTzA3S0cyaXhnL0wwWndmdVllSkNnMTV3RHpLNkNFM09MNHpwNnVSWSt3U0RQOWFuZAp4bit0Rk1Ib2g1aUVHTGlLckhTZEQvbE8zLzRJb3ZEeXRBbThWOEYzaG9wOUZXMEw3UkpvUzZYQXdCNHlJRVFuCkZGTE1RYWhQQWdNQkFBRUNnZ0VBRWFNbmd0ZjRIV2VWcU9hQ1lzVXRTdVFucHBmVzhtMmpJWkJPbEYwQzA1Z2UKNW5zc3ZvTG0ySkQ3ZzdDTjAwY0w4bnNOWGp5Q05NSWRkM09QcDRIOVpHUWhQY1huZC80Q0xQUUpZcXJlY1BDbwpZWFB4T2ZwRFlNWWRxTkNOZkZDQ3lqdEhoOEhmUzdPYU1tWTB3QkVBVWhQUG94bWRKODJ6MyswTnorbnIrdFVUClExbU9oZEtsVWl5bEszVWhTQ2VNL1J3bU9RU3ZPQksvdUprK3JxV3NtTDA3TUcybWxnaEJUSWx0UUJyTVF6MS8KZElFWG10ZDQvczF6SnlkbVhjNDVCd3p6VDRreiswY0RHcndQTDdEN1lSekNWaDFuT2U3WEtDaHl0M3UwS3lDVApmMjhhcE92N2dRNCttbGdtcFZZSW95SVdPRmdSendJMGd2RktuaDdEMVFLQmdRRDExSW9XT1dwNCt2aDRWaXdGClF0K2JrTTdIMW1jdlIvYkMwdlQ1UkxLeGVCYVUwc1lJY3owNE1MZzJZUVQ2WTdneWNkL1J1YWZpTUt6Mk16dzIKaWhsOUFmNXpNbXF0anVlRjlIbXhvekpobGhhMDhrdDJVZUxGbWpFcFA3QmovVldGOXp4bll3ZTg1S0c5SEZMUQpXNlVDZVVwS3gvRTNPTTR0STVOaEgzR0xYUUtCZ1FEczJkSGNmdC81L2k0VzlvZjNQRXczYm9HTDhTdzlpTVNNCjlZYXgwd0lKNUt4a1RRQ0h4R3l4dVFrWW51eGR5ZGFTa29ad05VMHJFcUVXSVNBVmVzazRPU3MzcDhLdXMrVlQKOURqNGR1NkJCcENtdFo4RVB6KzN6MFJpMzJML3VwNTE0eXArVzB1L2xDaEd1RnlLcWhYR2U0WXJTaWxheXVCMQpJcGZnalkzem13S0JnSC9WcG5rb0lsWUhMRzVuWVR6YktheWNBT3VxY3I0RGppNkJ4U0phdHhIU2dPdWpMNWYxClZVQ0RGVWd4NjRUSmxsK2xGOTdYekpXeStqNk5KaUsyYmNxejNyM0kyZkNtLzM2SlF6ODh2bFpBMWs0Q01YdTEKMlZjb2Q2Z2JsbjVvbnJDcmdKM0N3YU5Zd1VLMkY5cUJ6YTBicGFaOWt0SkVsL0toTFdLMEZ6ZUJBb0dBQ3ljZQptTEZvdm83WGdNRlBHYmMvSjRVT21KWmNyUEVad0VGM2ZEd2habkhjSkVUejkzQ3FaWnYrNzZmY0hYWjVvaUZBCkwxeHpLOG9PeDhuN2hzZG5YanhpNnBYOXR0aEZ2alJMMG5kWE44QWxZNVE5enFkanlyWDUxR1lNZFZwR1IrclEKZjI2eEhHNVBqelR6TnB4WHRpYnU1Rzd6ajVEcURObjZLTnJCaW0wQ2dZQWhxQXcwMVRLY3pnZlpRUHlGUjY1TgpNcDRqaTZkZUFkYUdMdmtTaHdma3FOVnNzZEpOclJGQ0ZIZTVVQ1pJMFdHQVQ5cHRZeGtiTjg0cVpPSDVxU0JNClV2blJQa2xkSWtPbFJzLzFUWkx2QUdJYmNwWUlBdCs0NGJjOGduTHE2OXRRSTVXVWc0V1dtTVVYYjhBOGpRaVUKMU41MzllSUFYVTRBSWRVMFlraW1Pdz09Ci0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K"

decrypted_aes_key_base64 = decrypt_aes_key_with_rsa(encrypted_aes_key_base64, private_key_pem_base64)

print(decrypted_aes_key_base64)
